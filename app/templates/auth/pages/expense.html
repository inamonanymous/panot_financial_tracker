{% extends 'auth/layout.html' %}
{% block body %}
    <!-- Sidebar -->
    {% include 'auth/partials/sidebar.html' %}
    <!-- End of Sidebar -->

    <!-- Main Content -->
    <div id="content">


        <!-- Topbar -->
            {% include 'auth/partials/topbar.html' %}
        <!-- End of Topbar -->

        <!-- Begin Page Content -->
        <div class="container-fluid">

            
            <!-- Page Heading -->
            <h1 class="h3 mb-2 text-gray-800">My Expense</h1>
            <p class="mb-4">
                Lorem ipsum dolor sit amet, consectetur adipiscing elit. Sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam, quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo consequat.
            </p>

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-toggle="modal" data-target="#exampleModal">
  Add expense
</button>
{% if error_message %}
    <label for="validationError" class="form-label text-danger">
        {{ error_message }}
    </label>
{% endif %}
<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Add Expense</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <form method="POST" action="{{ url_for('expense.insert_expense_route') }}">
            <div class="form-group">
                <label for="input_category_id">Category</label>
                <select class="form-control" id="input_category_id" name="category_id" required>
                    <option value="">-- Select Category --</option>
                    {% for cat in user_categories %}  <!-- Get categories from use case -->
                        <option value="{{ cat.id }}">{{ cat.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <!-- Source field -->
            <input type="text" class="form-control" id="input_payee" name="payee" placeholder="Payee name" required>

            <!-- Amount field -->
            <input type="number" step="0.01" class="form-control" id="input_amount" name="amount" placeholder="0.00" required>

            <!-- Received Date field -->
            <input type="date" class="form-control" id="input_expense_date" name="expense_date" required>

            <!-- Payment Method field -->
            <select class="form-control" id="input_method" name="payment_method">
                <option value="cash">Cash</option>
                <option value="gcash">G-Cash</option>
                <option value="bank">Bank</option>
                <option value="card">Card</option>
                <option value="other">Other</option>
            </select>

            <!-- Remarks field -->
            <textarea class="form-control" id="input_remarks" name="remarks" placeholder="Optional notes"></textarea>

            <!-- Submit button -->
            <button type="submit" class="btn btn-primary">Add expense</button>
        </form>

      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
      </div>
    </div>
  </div>
</div>
            <!-- DataTales Example -->
            <div class="card shadow mb-4">
                <div class="card-header py-3">
                    <h6 class="m-0 font-weight-bold text-primary">My Expenses</h6>
                </div>
                <div class="card-body">
                    <div class="table-responsive">
                        <table class="table table-bordered" id="dataTable" width="100%" cellspacing="0">
                            <thead>
                                <tr>
                                    <th>Category</th>
                                    <th>Payee</th>
                                    <th>Amount</th>
                                    <th>Expense Date</th>
                                    <th>Method</th>
                                    <th>Remarks</th>
                                    <th>Created At</th>
                                </tr>
                            </thead>
                            <tfoot>
                                <tr>
                                    <th>Category</th>
                                    <th>Payee</th>
                                    <th>Amount</th>
                                    <th>Expense Date</th>
                                    <th>Method</th>
                                    <th>Remarks</th>
                                    <th>Created At</th>
                                </tr>
                            </tfoot>
                            <tbody>
                                {% for i in expense %}
                                    <tr>
                                        <td>{{ i.category_name }}</td>
                                        <td>{{ i.payee }}</td>
                                        <td>{{ i.amount }}</td>
                                        <td>{{ i.expense_date }}</td>
                                        <td>{{ i.payment_method }}</td>
                                        <td>{{ i.remarks }}</td>
                                        <td>{{ i.created_at }}</td>
                                    </tr>
                                {% endfor %}
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>

        </div>
        <!-- /.container-fluid -->

    </div>
<!-- End of Main Content -->

{% endblock %}

